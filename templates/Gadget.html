<!DOCTYPE html>
<html lang="en">
<head>
    <title>Tech Nova - Home</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
    <div class="overlay" id="overlay"></div>

    <!-- Login Popup -->
    <div class="popup-container" id="loginPopupContainer">
        <button class="close-btn" onclick="closeLoginPopup()"><i class="fas fa-times"></i></button>
        <div class="login-popup" id="loginPopup">
            <div class="login-form">
                <input type="text" placeholder="Username or Email" id="loginUsernameEmail" required>
                <input type="password" placeholder="Password" id="loginPassword" required>
                <button class="login-submit-btn" onclick="submitLogin()">Login</button>
                <button class="login-cancel-btn" onclick="closeLoginPopup()">Cancel</button>
                <p style="text-align: center; margin-top: 10px;">
                    Don't have an account? <a href="#" onclick="openCreateAccountPopup()">Create one</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Create New Account Popup -->
    <div class="popup-container" id="createAccountPopupContainer">
        <button class="close-btn" onclick="closeCreateAccountPopup()"><i class="fas fa-times"></i></button>
        <div class="login-popup" id="createAccountPopup">
            <div class="login-form">
                <input type="text" placeholder="Username" id="createUsername" required>
                <input type="email" placeholder="Email Address" id="createEmail" required>
                <input type="password" placeholder="Password" id="createPassword" required>
                <input type="password" placeholder="Re-enter Password" id="createPasswordConfirm" required>
                <select id="createGender" required>
                    <option value="" disabled selected>Select Gender</option>
                    <option value="male">Male</option>
                    <option value="female">Female</option>
                    <option value="other">Other</option>
                </select>
                <input type="number" placeholder="Age" id="createAge" min="13" max="120" required>
                <p style="font-size: 12px; color: #555; margin: 10px 0;">
                    Password must include digits (0-9), alphabets (upper/lowercase), and symbols (e.g., *_)
                </p>
                <button class="login-submit-btn" onclick="submitCreateAccount()">Create Account</button>
                <button class="login-cancel-btn" onclick="closeCreateAccountPopup()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- User Profile Popup -->
    <div class="popup-container" id="userPopupContainer">
        <button class="close-btn" onclick="closeUserPopup()"><i class="fas fa-times"></i></button>
        <div class="user-popup" id="userPopup">
            <div class="user-profile">
                <img src="https://ui-avatars.com/api/?name=John+Doe&background=1e90ff&color=fff" alt="User Avatar" class="user-avatar" id="userAvatar">
                 <h3 class="user-name" id="userName">John Doe</h3>
                <p class="user-email" id="userEmail">user@example.com</p>
                <!-- Home.html -->
                <div class="user-stats">
                    <div class="stat-item">
                        <div class="stat-value" id="userLikes">0</div>
                        <div class="stat-label">Likes</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="userFollowing">0</div>
                        <div class="stat-label">Following</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="userReports">0</div>
                        <div class="stat-label">Reports</div>
                    </div>
                </div>
                <button class="logout-btn" onclick="logoutUser()"><i class="fas fa-sign-out-alt"></i> Logout</button>
            </div>
        </div>
    </div>

    <!-- Modern Calendar Popup -->
    <div class="popup-container" id="calendarPopupContainer">
        <button class="close-btn" onclick="closeCalendarPopup()"><i class="fas fa-times"></i></button>
        <div class="calendar-popup" id="calendarPopup">
            <div class="calendar-header">
                <button class="calendar-nav-btn" onclick="prevMonth()"><i class="fas fa-chevron-left"></i></button>
                <div class="calendar-month-year" id="calendarMonthYear"></div>
                <button class="calendar-nav-btn" onclick="nextMonth()"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="calendar-grid" id="calendarGrid"></div>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="date-container">
            <span class="date">{{ current_date }}</span>
            <i class="fas fa-calendar-alt calendar-icon" onclick="openCalendarPopup()"></i>
        </div>
        <div class="logo-container">
            <header><img src="{{ url_for('static', filename='uploads/technova.png') }}" alt="Tech Nova Logo" class="logo"></header>
        </div>
        <div class="search-login-container">
            <div class="search-container">
                <input type="text" placeholder="search" id="searchInput" class="search-bar-inline">
                <button class="search-btn" onclick="performSearch()"><i class="fas fa-search"></i></button>
            </div>
            <div class="icons">
                <div id="userLoginBtn" class="login-btn" onclick="openLoginPopup()"><i class="fas fa-user"></i><span>Login</span></div>
                <div id="userProfileBtn" style="display: none;" onclick="openUserPopup()">
                    <img src="https://ui-avatars.com/api/?name=John+Doe&background=1e90ff&color=fff" alt="User" class="user-avatar-small">
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation with Active Highlight -->
    <div class="nav">
        <a href="/" class="{{ 'active' if request.path == '/' else '' }}">HOME</a>
        <a href="/AI" class="{{ 'active' if request.path == '/AI' else '' }}">AI</a>
        <a href="/Gadget" class="{{ 'active' if request.path == '/Gadget' else '' }}">GADGET</a>
        <a href="/Apps" class="{{ 'active' if request.path == '/Apps' else '' }}">APPS</a>
        <a href="/Blockchain" class="{{ 'active' if request.path == '/Blockchain' else '' }}">BLOCKCHAIN</a>
        <a href="/Cybersecurity" class="{{ 'active' if request.path == '/Cybersecurity' else '' }}">CYBER SECURITY</a>
    </div>

    <!-- Featured Articles -->
    <div class="content">
        {% if featured_articles %}
            <div class="left">
                {% for article in featured_articles[:2] %}
                    <div class="news-box" data-article-id="{{ article._id }}">
                        <img alt="{{ article.title }}" src="{{ article.image_url or 'https://via.placeholder.com/300' }}"/>
                        <div class="info">
                            <div class="likes" onclick="toggleLike(this)"><i class="fas fa-thumbs-up"></i><span>{{ article.likes or '0' }}</span></div>
                            <div class="report" onclick="reportPost(this)">Report</div>
                        </div>
                        <div class="details">
                            <div class="source">{{ article.source }} <span class="follow {{ 'following' if article.is_following else '' }}" onclick="toggleFollow(this)">{{ 'Following' if article.is_following else '+ Follow' }}</span></div>
                            <a href="{{ article.url }}" class="description-link"><div class="description">{{ article.summary }}</div></a>
                            <div class="time">{{ article.published_at }}</div>
                        </div>
                    </div>
                {% else %}
                    <p>No featured articles available.</p>
                {% endfor %}
            </div>
            <div class="right">
                {% for article in featured_articles[2:4] %}
                <div class="news-box" data-article-id="{{ article._id }}">
                        <img alt="{{ article.title }}" src="{{ article.image_url or 'https://via.placeholder.com/300' }}"/>
                        <div class="info">
                            <div class="likes" onclick="toggleLike(this)"><i class="fas fa-thumbs-up"></i><span>{{ article.likes or '0' }}</span></div>
                            <div class="report" onclick="reportPost(this)">Report</div>
                        </div>
                        <div class="details">
                            <div class="source">{{ article.source }} <span class="follow {{ 'following' if article.is_following else '' }}" onclick="toggleFollow(this)">{{ 'Following' if article.is_following else '+ Follow' }}</span></div>
                            <a href="{{ article.url }}" class="description-link"><div class="description">{{ article.summary }}</div></a>
                            <div class="time">{{ article.published_at }}</div>
                        </div>
                    </div>
                {% else %}
                    <p>No featured articles available.</p>
                {% endfor %}
            </div>
        {% else %}
            <p>No featured articles available.</p>
        {% endif %}
    </div>

    <!-- News Grid -->
    <div class="container">
        <div class="news-grid">
            {% for article in articles[4:20] %}
            <div class="news-item" data-article-id="{{ article._id }}">
                <img src="{{ article.image_url or 'https://via.placeholder.com/300' }}" alt="{{ article.title }}">
                <div class="info">
                    <div class="likes" onclick="toggleLike(this)"><i class="fas fa-thumbs-up"></i><span>{{ article.likes or '0' }}</span></div>
                    <div class="report" onclick="reportPost(this)">Report</div>
                </div>
                <div class="news-title">{{ article.title }}</div>
                <a href="{{ article.url }}" class="description-link"><div class="news-description">{{ article.summary }}</div></a>
                <div class="news-author">{{ article.source }} <span class="follow {{ 'following' if article.is_following else '' }}" onclick="toggleFollow(this)">{{ 'Following' if article.is_following else '+ Follow' }}</span></div>
            </div>
            {% else %}
                <p>No additional articles available.</p>
            {% endfor %}
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        Â© 2025 Tech Nova. All rights reserved. | <a href="#">Privacy Policy</a> | <a href="#">Terms of Service</a>
    </div>

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
</body>
</html>